(window.webpackJsonpReactComponents=window.webpackJsonpReactComponents||[]).push([[0],{202:function(e,t,a){"use strict";var r=a(190),i=a.n(r),s=a(12),c=a.n(s),n=a(71),l=a.n(n),o=a(72),d=a(73);t.a=(e,t)=>{const a=a=>{const r={...a},{wrappedActivityData:n,activityType:l,activityId:o}=a;delete r.wrappedActivityData,Object(s.useEffect)(()=>{t({activityType:l,activityId:o})},[]);let d=n||{};return n?c.a.createElement(e,i()({},r,d)):null};a.propTypes={wrappedActivityData:l.a.shape({screenId:l.a.number,activityId:l.a.string,activityType:l.a.string})};return Object(o.connect)((e,t)=>({wrappedActivityData:Object(d.a)(e,t)}),null)(a)}},203:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return c}));var r=a(18);const i={},s=({activityType:e,reducer:t,saga:a})=>{t&&Object(r.d)(t),a&&Object(r.e)(a),i[e]=!0},c=e=>Boolean(i[e])},204:function(e,t,a){"use strict";var r=a(190),i=a.n(r),s=a(12),c=a.n(s),n=a(71),l=a.n(n),o=a(84);const d=({correct:e,wrong:t,revealed:a,classNames:r,tooltip:s,Component:n=o.a,...l})=>{const d=c.a.createElement(n,i()({correct:e,wrong:t,revealed:a,classNames:r},l));return s?c.a.createElement(o.c,{tooltip:s},d):d};d.propTypes={correct:l.a.bool,wrong:l.a.bool,revealed:l.a.bool,classNames:l.a.array},t.a=d},272:function(e,t){},274:function(e,t){},334:function(e,t,a){"use strict";a.r(t);var r=a(12),i=a.n(r),s=a(71),c=a.n(s),n=a(72),l=a(202),o=a(14),d=a(10),u=a(203),y=a(3),p=a(2),v=a(53),b=a(7),m=a.n(b),f=a(6);const I=(e,t)=>t.screenId,C=m()([e=>e.screens,I],(e,t)=>{if(e&&t)return e[t.toString()]})(I);var g=a(24),O=a(77),w=a.n(O),h=a(54);const D=Object(g.createSelector)([e=>e.lo],e=>e.options),j=(m()([D,h.b,h.a],(e,t,a)=>{if(!e||!t||!a)return;const{loOption:r,option:i}=j(e,t,a);return i?r?r.value||r.key:i.values[0].key:void 0})(h.a),m()([D,h.b,h.a],(e,t,a)=>{if(!e||!t||!a)return;const{loOption:r,option:i}=j(e,t,a);return i?r?r.key:i.values[0].key:void 0})(h.a),(e,t,a)=>{const r=t.find(e=>w()(e.name)===w()(a)),i=e.get(r.id.toString());return{option:r,loOption:i}});a(227),a(228);const x=Object(g.createSelector)([C],e=>e.options),E=m()([x,D,h.b,h.a],(e,t,a,r)=>{if(!(e&&t&&a&&r))return;const{screenOption:i,loOption:s,option:c}=T(e,t,a,r);return c?i?i.value||i.key:s?s.value||s.key:c.values[0].key:void 0})(h.a),S=m()([x,D,h.b,h.a],(e,t,a,r)=>{if(!(e&&t&&a&&r))return;const{screenOption:i,loOption:s,option:c}=T(e,t,a,r);return c?i?i.key:s?s.key:c.values[0].key:void 0})(h.a),T=(e,t,a,r)=>{const i=a.find(e=>w()(e.name)===w()(r)),s=t[i.id.toString()],c=e[i.id.toString()];return{option:i,loOption:s,screenOption:c}},U=(e,t)=>"lower"===S(e,t,"case"),R=(e,t)=>"inside"===S(e,t,"cluePosition"),k=(e,t)=>"pause"===S(e,t,"audioIconBehaviour"),A=(e,t)=>"on"===S(e,t,"cluesInColumns"),P=(e,t)=>"on"===S(e,t,"audioSpeed"),_=(e,t)=>E(e,t,"mediaPlaybackLimit");var q=a(45);const B=(e,t)=>Math.max(Math.abs(t.x-e.x),Math.abs(t.y-e.y))+1,$=(e,t)=>{const a=((e,t)=>({dx:Math.sign(t.x-e.x),dy:Math.sign(t.y-e.y)}))(e,t),r=B(e,t);let{x:i,y:s}=e;const c=[];return Array.from({length:r}).forEach(()=>{c.push({x:i,y:s}),i+=a.dx,s+=a.dy}),c},z=(e,t)=>e.filter(({x0:e,y0:a,x1:r,y1:i})=>((e,t,a)=>$(t,a).some(({x:t,y:a})=>e.x===t&&e.y===a))(t,{x:e,y:a},{x:r,y:i})),L=(e,t)=>B({x:e.x0,y:e.y0},t)-1,V=(e,t)=>{const a=L(e,t);return 0===a?"first":a===B({x:e.x0,y:e.y0},{x:e.x1,y:e.y1})-1?"last":"middle"},F=(e,t)=>`${e}_${t}`,N=(e,t)=>`${F(e.x,e.y)}_${F(t.x,t.y)}`,M=e=>e.iccrossword_cells_uiData,W=(e,t)=>t.activityId,H=(e,t)=>t.id,K=Object(f.a)([M],e=>{if(e)return Object.values(e)}),G=m()([K,W],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})(W,{selectorCreator:f.a}),J=m()([M,H],(e,t)=>{if(e&&t)return e[t]})(H),Y=m()([J],e=>{if(e)return e.dataType})(H),Q=m()([G],e=>{if(e)return e.filter(({dataType:e})=>"solution"===e)})(W,{selectorCreator:f.a}),X=m()([G],e=>{if(e)return e.filter(({enabled:e})=>e)})(W,{selectorCreator:f.a}),Z=e=>e.iccrossword_cells_itemData,ee=(e,t)=>t.activityId,te=(e,t)=>t.id,ae=Object(f.a)([Z],e=>{if(e)return Object.values(e)}),re=m()([ae,ee],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})(ee,{selectorCreator:f.a}),ie=m()([Z,te],(e,t)=>{if(e&&t)return e[t]})(te),se=(m()([re,Q],(e,t)=>{if(!e||!t)return;const a=t.map(({id:e})=>e);return e.filter(e=>a.includes(e.id))})(ee,{selectorCreator:f.a}),m()([re,X],(e,t)=>{if(!e||!t)return;const a=t.map(({id:e})=>e);return e.filter(e=>a.includes(e.id))})(ee,{selectorCreator:f.a})),ce=m()([q.getActivityItemData,R],(e,t)=>{if(!e||null==t)return;if(!t)return[];const a=[];return e.forEach(e=>{const t={x:e.x0,y:e.y0,type:"clue",words:[e.id]};"v"===e.align?t.y--:t.x--;a.find(e=>e.x===t.x&&e.y===t.y)||a.push(t)}),a})(ee,{selectorCreator:f.a}),ne=m()([re,ce,(e,t)=>t.index],(e,t,a)=>{if(e&&null!=a&&t)return e.filter(e=>e.y===a).map(e=>{const a=t.find(t=>t.x===e.x&&t.y===e.y);return{...e,...a}})})((e,t)=>`${t.activityId}${t.index}`,{selectorCreator:f.a}),le=m()([ie,q.getActivityItemData],(e,t)=>{if(e&&t)return t.filter(t=>e.words.includes(t.id))})(te,{selectorCreator:f.a}),oe=m()([(e,{words:t})=>t,q.getActivityItemData],(e,t)=>{if(e&&t)return t.filter(({id:t})=>e.includes(t))})(te,{selectorCreator:f.a}),de=m()([q.getActivityItemData,se],(e,t)=>{if(!e||!t)return;const a=[...new Set(t.flatMap(({words:e})=>e))];return e.filter(e=>a.includes(e.id))})(ee,{selectorCreator:f.a}),ue=(m()([(e,t)=>{const{x0:a,y0:r,x1:i,y1:s}=t;return $({x:a,y:r},{x:i,y:s})},re],(e,t)=>{if(e&&t)return e.map(({x:e,y:a})=>t.find(t=>t.x===e&&t.y===a))})(te,{selectorCreator:f.a}),m()([ae,(e,t)=>t.cells],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})((e,t)=>JSON.stringify([...t.cells||[]].sort()),{selectorCreator:f.a}));var ye=a(22);const pe=Object(y.c)({name:"iccrossword_cell_itemData",initialState:{},reducers:{addCellsItemData:(e,t)=>({...e,...t.payload.data}),clearCellsItemData:(e,{payload:{data:t}})=>Object.keys(e).reduce((a,r)=>(t.includes(r)||(a[r]=e[r]),a),{})}}),ve=pe.reducer,be=pe.actions,me=Object(y.c)({name:"iccrossword_cell_userData",initialState:{},reducers:{setCellsUserData:(e,t)=>({...e,...t.payload.data}),clearCellsUserData:(e,t)=>{const a=t.payload.data;return Object.keys(e).reduce((t,r)=>(a.includes(r)||(t[r]=e[r]),t),{})}}}),fe=me.reducer,Ie=me.actions,Ce=Object(y.c)({name:"iccrossword_cell_solutionData",initialState:{},reducers:{addCellsSolutionData:(e,t)=>({...e,...t.payload.data}),clearCellsSolutionData:(e,{payload:{data:t}})=>Object.keys(e).reduce((a,r)=>(t.includes(r)||(a[r]=e[r]),a),{})}}),ge=Ce.reducer,Oe=Ce.actions;var we=a(58);const he=Object(y.c)({name:"iccrossword_cell_uiData",initialState:{},reducers:{setCellUIData:(e,t)=>{t.payload.data.forEach(t=>{e[t.id]={...e[t.id],...t}})},clearCellUIData:(e,t)=>{const a=t.payload.data;return Object.keys(e).reduce((t,r)=>(a.includes(r)||(t[r]=e[r]),t),{})}},extraReducers:{[be.addCellsItemData.type]:(e,{payload:{data:t}})=>({...e,...Object.values(t).reduce((e,t)=>(e[t.id]={id:t.id,activityId:t.activityId,enabled:we.a.enabled,dataType:we.a.dataType},e),{})})}}),De=he.reducer,je=he.actions;var xe={iccrossword_cells_itemData:ve,iccrossword_cells_userData:fe,iccrossword_cells_solutionData:ge,iccrossword_cells_uiData:De};const Ee={...be,...Ie,...Oe,...je};var Se=a(23);const Te=Object(y.b)("iccrosswordSetCellData"),Ue=Object(y.b)("iccrosswordClearCellData");function*Re(e){try{const{cell:t,words:a,userData:r}=yield*Ae(e.payload),i=a.map(a=>{const i=r.find(e=>e.id===a.id);let s=a.cells.indexOf(t.id),c=Pe(e.payload.value,null==i?void 0:i.value,s,a.cells.length);return{id:a.id,activityId:t.activityId,value:c}});yield Object(p.b)(Ee.setCellsUserData({data:Object(v.b)([e.payload]).entities.userData})),yield Object(p.b)(Se.a.setUserData({activityType:"iccrossword",data:Object(v.b)(i).entities.userData})),Object(o.c)(d.b.VALUE_CHANGE,{type:"iccrossword",id:e.payload.activityId})}catch(e){throw Error(e.message)}}function*ke(e){try{const{cell:t,words:a,userData:r}=yield*Ae(e.payload),i=[],s=[];a.forEach(e=>{const a=r.find(t=>t.id===e.id);let c,n=e.cells.indexOf(t.id);c=Pe(" ",null==a?void 0:a.value,n,e.cells.length),c.trim()?i.push({id:e.id,value:c}):s.push(e.id)}),yield Object(p.b)(Ee.clearCellsUserData({data:[t.id]})),i.length&&(yield Object(p.b)(Se.a.setUserData({activityId:t.activityId,activityType:"iccrossword",data:Object(v.b)(i).entities.userData}))),s.length&&(yield Object(p.b)(Se.a.clearUserData({activityId:t.activityId,activityType:"iccrossword",data:s}))),Object(o.c)(d.b.VALUE_CHANGE,{type:"iccrossword",id:e.payload.activityId})}catch(e){throw Error(e.message)}}function*Ae(e){const t=yield Object(p.c)(ie,e);return{cell:t,words:yield Object(p.c)(le,t),userData:yield Object(p.c)(ye.getUserDataByIds,{activityId:t.activityId,ids:t.words})}}const Pe=(e,t,a,r)=>{if(t)return`${t.substr(0,a)}${e}${t.substr(a+1,r-a)}`;{let t=new Array(r).fill(" ");return t[a]=e,t.join("")}};var _e={watchSetCellUserData:function*(){yield Object(p.d)(Te.type,Re)},watchClearCellUserData:function*(){yield Object(p.d)(Ue.type,ke)}};const qe={setCellUserData:Te,clearCellUserData:Ue};var Be=a(32),$e=a(68),ze=a(63),Le=a(36),Ve=a(9),Fe=a(76);const Ne=new Ve.b.Entity("cellsItemData",{words:Fe.a}),Me=[Ne];var We=a(92);function*He(e){const{id:t,itemData:a,solutionData:r,metadata:i}=e,{cells:s,...c}=i,n=a.map(e=>{const{x0:a,y0:r,x1:i,y1:s}=e,c=N({x:a,y:r},{x:i,y:s}),n=$({x:a,y:r},{x:i,y:s}).map(e=>`${t}_${F(e.x,e.y)}`);return{id:`${t}_${c}`,...e,activityId:t,cells:n}}),l={};let o=1;n.forEach(e=>{const t=e.cells[0];l[t]=l[t]||o++,e.label=l[t]});const d=r.map(e=>{const{x0:a,y0:r,x1:i,y1:s,word:c}=e,n=N({x:a,y:r},{x:i,y:s});return{id:`${t}_${n}`,value:c,activityId:t}}),u=s.map(e=>{const a=z(n,e),r=F(e.x,e.y),i=`${t}_${r}`;return{id:i,...e,words:a,label:l[i],activityId:t}}),y=u.filter(({words:e})=>e.length).map(e=>{const a=e.words[0],r=d.find(({id:e})=>e===a.id).value.charAt(L(a,e)),i=F(e.x,e.y);return{id:`${t}_${i}`,value:r,activityId:t}}),p=(v=u,Object(Ve.a)(v,Me)).entities.cellsItemData;var v;const b=Object(We.b)(y).entities.solutionData,m=yield Be.b.addActivities({...e,itemData:n,solutionData:d,metadata:c}),f=Ee.addCellsItemData({data:p}),I=Ee.addCellsSolutionData({data:b});return m.concat([f,I])}function*Ke(e){const{id:t}=e,a=(yield Object(p.c)(re,{activityId:t})).map(({id:e})=>e),r=yield Be.b.removeActivities(e),i=Ee.clearCellsItemData({data:a}),s=Ee.clearCellsSolutionData({data:a}),c=Ee.clearCellsUserData({data:a}),n=Ee.clearCellUIData({data:a});return r.concat([i,s,c,n])}var Ge=a(25),Je=a(56),Ye=a(93);function*Qe(e){const{activityId:t}=e,a=yield Object(p.c)(q.getItemDataByIds,e),r=yield Object(p.c)(Ye.a,e),i=yield Object(p.c)(ye.getUserDataByIds,e);let s=yield Object(p.c)(Q,e);if(s=s.map(e=>e.id),a.length){const e=a.map(e=>{var a,c;const n=null===(a=i.find(t=>t.id===e.id))||void 0===a?void 0:a.value,l=null===(c=r.find(t=>t.id===e.id))||void 0===c?void 0:c.value;let o=n||new Array(l.length).fill(" ").join("");return e.cells.forEach((e,t)=>{s.includes(e)&&(o=`${o.slice(0,t)}${l.charAt(t)}${o.slice(t+1,o.length)}`)}),{id:e.id,activityId:t,correct:Boolean(n&&o.toLowerCase()===l.toLowerCase()),filled:Boolean(n&&-1===o.indexOf(" "))}});return[Ge.a.addValidation({activityType:"iccrossword",data:Object(Je.b)(e).entities.validationData})]}return[]}const Xe="iccrossword";function*Ze(e){const t=yield Object(p.c)(q.getItemDataByIds,{ids:e.data.map(e=>e.id)}),a=ze.b.setUserData(e),r=[];return e.data.forEach(({id:a,value:i})=>{const s=t.find(e=>e.id===a),c=i.split("");s.cells.forEach((t,a)=>{c[a].trim()&&!r.find(({id:e})=>e===t)&&r.push({id:t,activityId:e.activityId,value:c[a]})})}),r.length&&a.push(Ee.setCellsUserData({data:Object(v.b)(r).entities.userData})),a}function*et(e){try{const t=yield Object(p.c)(q.getItemDataByIds,e),a=yield Object(p.c)(ye.getUserDataByIds,e),r=t.map(({id:e})=>e),i=[];let s=[];const c=[],n=[];return yield*t.map((function*(e){var t;const i=yield Object(p.c)(ue,{cells:e.cells});let l=null===(t=a.find(({id:t})=>t===e.id))||void 0===t?void 0:t.value.split("");if(i.map(e=>e.words).flat().every(e=>r.includes(e)))c.push(e.id),s=[...s,...e.cells];else{var o;const t=i.filter(e=>e.words.every(e=>r.includes(e)));s=[...s,...t.map(({id:e})=>e)],null!==(o=l)&&void 0!==o&&o.length&&(l=l.map((e,a)=>t.includes(i[a])?" ":e).join(""),l.trim()?n.push({id:e.id,activityId:e.activityId,value:l}):(c.push(e.id),s=[...s,...e.cells]))}})),c.length&&i.push(Se.a.clearUserData({activityType:Xe,data:c})),n.length&&i.push(Se.a.setUserData({activityType:Xe,data:Object(v.b)(n).entities.userData})),s.length&&i.push(Ee.clearCellsUserData({data:[...new Set(s)]})),i}catch(e){throw new Error(e.message)}}var tt=a(46);function*at(e){const t=yield Le.b.setEnabled(e),a=yield lt(e);return t.concat(a)}function*rt(e){const t=yield Le.b.setDataType(e),a=yield lt(e);return t.concat(a)}function*it(e){const t=yield Le.b.setValidationType(e),a=yield lt(e);return t.concat(a)}function*st(e){const t=yield Le.b.setBatchUI(e),a=yield lt(e);return t.concat(a)}const ct=(e,t)=>e.words.every(e=>t.includes(e)),nt=(e,t,a)=>e.words.filter(({id:e})=>!t.includes(e)).map(e=>a.find(t=>t.id===e));function*lt(e){let{activityId:t,ids:a,data:r,enabled:i,validationType:s,dataType:c,extra:n}=e;r=r||{enabled:i,validationType:s,dataType:c,extra:n};const l=yield function*(e){return(yield Object(p.c)(q.getItemDataByIds,{ids:e.ids})).map(({cells:e})=>e).flat()}(e),o=yield Object(p.c)(tt.getActivityUIData,{activityId:t}),d=[];return yield*l.map((function*(e){const i=yield Object(p.c)(ie,{id:e});let s={};void 0!==r.enabled&&(s=Object.assign(s,((e,t,a,r)=>{const i={},s=nt(t,a,r);return(!e||ct(t,a)||s.every(t=>t.enabled===e))&&(i.enabled=e),i})(r.enabled,i,a,o))),void 0!==r.dataType&&(s=Object.assign(s,((e,t,a,r)=>{const i={},s=nt(t,a,r);return("solution"===e||ct(t,a)||s.every(t=>t.dataType===e))&&(i.dataType=e),i})(r.dataType,i,a,o))),d.push({...s,id:e,activityId:t})})),[Ee.setCellUIData({data:d})]}var ot=a(27),dt=a(69),ut=a(73),yt=a(40);const pt=(e,t)=>t.activityId,vt=(e,t)=>t.words,bt=m()([ut.a],e=>{if(e)return e.metadata.colSize})(pt),mt=m()([ut.a],e=>{if(e)return e.metadata.rowSize})(pt),ft=m()([q.getActivityItemData,(e,t)=>t.align],(e,t)=>{if(e&&t)return e.filter(e=>e.align===t)})(pt,{selectorCreator:f.a}),It=m()([q.getActivityItemData,tt.getActivityUIDataDataTypeSolution,ye.getActivityUserData],(e,t,a)=>{if(!e||!t||!a)return;const r=t.map(({id:t})=>e[t]).filter(Boolean),i=[...new Set(r.flatMap(e=>e.cells))];return e.filter(e=>{const t=a.find(t=>t.id===e.id);if(!t||!t.value.trim())return;return t.value.split("").filter((t,a)=>i.includes(e.cells[a])||t.trim()).length===e.cells.length})})(pt,{selectorCreator:f.a}),Ct=m()([ye.getActivityUserData,It],(e,t)=>{if(e&&t)return t.map(({id:t})=>e.find(e=>e.id===t))})(pt,{selectorCreator:f.a}),gt=m()([ye.getActivityUserData,vt],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})(pt,{selectorCreator:f.a}),Ot=m()([tt.getActivityUIData,vt],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})(pt,{selectorCreator:f.a}),wt=m()([yt.getActivityValidationData,vt],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})(pt,{selectorCreator:f.a});var ht=({activityType:e,activityId:t})=>{Object(u.a)(e)||(Object(Be.c)("addActivities","iccrossword",He),Object(Be.c)("removeActivities","iccrossword",Ke),Object($e.b)("validate","iccrossword",Qe),Object(ze.c)("setUserData","iccrossword",Ze),Object(ze.c)("clearUserData","iccrossword",et),Object(Le.c)("setEnabled","iccrossword",at),Object(Le.c)("setDataType","iccrossword",rt),Object(Le.c)("setValidationType","iccrossword",it),Object(Le.c)("setBatchUI","iccrossword",st),Object(ot.a)("getActivityItemDataFilteredByFilled","iccrossword",It),Object(dt.a)("getActivityUserDataFilled","iccrossword",Ct),Object(u.b)({activityType:e,saga:_e,reducer:xe})),Object(o.c)(d.b.READY,{type:e,id:t})},Dt=a(190),jt=a.n(Dt),xt=a(204);const Et=DPReactComponents.components.activities.ICCrossword.ICCrossword,St=DPReactComponents.components.activities.ICCrossword.ICCrosswordGrid,Tt=DPReactComponents.components.activities.ICCrossword.ICCrosswordRow,Ut=DPReactComponents.components.activities.ICCrossword.ICCrosswordCellInput,Rt=DPReactComponents.components.activities.ICCrossword.ICCrosswordCellClue,kt=DPReactComponents.components.activities.ICCrossword.ICCrosswordCellInvisible,At=DPReactComponents.components.activities.ICCrossword.ICCrosswordClue,Pt=DPReactComponents.components.activities.ICCrossword.ICCrosswordClueList,_t=DPReactComponents.components.activities.ICCrossword.ICCrosswordClues,qt=DPReactComponents.components.activities.ICCrossword.ICCrosswordClueInCell,Bt=i.a.createContext({focusedIndex:0});Bt.displayName="ICCrosswordUserDataContext";const $t=i.a.createContext({});$t.displayName="ICCrosswordFocusContext";const zt=i.a.createContext({});zt.displayName="ICCrosswordHighlightContext";const Lt=e=>e.iccrossword_cells_solutionData,Vt=(e,t)=>t.id,Ft=(e,t)=>t.activityId,Nt=Object(f.a)([Lt],e=>{if(e)return Object.values(e)}),Mt=(m()([Nt,Ft],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})(Ft,{selectorCreator:f.a}),m()([Lt,Vt],(e,t)=>{if(t&&e)return e[t]})(Vt)),Wt=m()([Mt,Y],(e,t)=>{if(e&&t&&"user"!==t)return e.value})(Vt),Ht=e=>e.iccrossword_cells_userData,Kt=(e,t)=>t.activityId,Gt=(e,t)=>t.id,Jt=Object(f.a)([Ht],e=>{if(e)return Object.values(e)}),Yt=(m()([Jt,Kt],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})(Kt,{selectorCreator:f.a}),m()([Ht,Gt],(e,t)=>{if(e&&t)return e[t]})(Gt)),Qt=m()([Yt],e=>e?e.value:"")(Gt),Xt=e=>1===e.length,Zt=["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],ea="Unidentified",ta="Dead",aa="Shift",ra=e=>{var t;const{id:a,x:s,y:c,label:n,lowercase:l,solutionDataValue:o,userDataValue:d,uiData:u,words:y,wordsUIData:p,wordsValidationData:v,wordsUserData:b}=e,m=Object(r.useContext)(Bt),f=Object(r.useContext)($t),I=Object(r.useContext)(zt),[C,g]=Object(r.useState)([]),[O,w]=Object(r.useState)(),[h,D]=Object(r.useState)(),j="solution"===u.dataType?o:d;Object(r.useEffect)(()=>{w(null),D(null);const e=y.map(e=>{const{cells:t,label:r,align:i}=e,n=e.id,l=V(e,{x:s,y:c}),o=v.find(e=>e.id===n),d=p.find(e=>e.id===n),y=b.find(e=>e.id===n),m={relativePosition:l,orientation:"v"===i?"vertical":"horizontal",wordLabel:r,userWord:null==y?void 0:y.value,length:t.length,position:t.indexOf(a),classes:(null==d?void 0:d.extra)||[]};if(null!=d&&d.validationType){let e=!1;if(null!=o&&o.hasOwnProperty("correct")&&null!=o&&o.filled&&(m.isCorrect=o.correct,e=!0),"correct_incorrect_empty"===(null==d?void 0:d.validationType)&&null!=o&&o.hasOwnProperty("filled")&&(m.isFilled=o.filled,e=!0),e){const e=m.isCorrect||"solution"!==u.dataType?void 0:m.userWord,t={correct:!0===m.isCorrect,wrong:!1===m.isCorrect,revealed:void 0===m.isCorrect,tooltip:e,classNames:[m.orientation]};"v"===i?D(t):w(t)}}return m});g(e)},[y,v,u]);const x=null===(t=I.highlighted)||void 0===t?void 0:t.includes(a),E=f.focusedCellId===a,S=x&&I.highlighted.includes(f.focusedCellId),T=y.some(({id:e})=>e===f.focusedWordId)||S;return i.a.createElement(Ut,{letter:j,enabled:u.enabled,label:n,lowercase:l,focused:E,highlighted:x,focusHighlighted:T,orientations:C,horizontalCheckmark:O&&i.a.createElement(xt.a,{correct:O.correct,wrong:O.wrong,revealed:O.revealed,tooltip:O.tooltip,classNames:O.classNames}),verticalCheckmark:h&&i.a.createElement(xt.a,{correct:h.correct,wrong:h.wrong,revealed:h.revealed,tooltip:h.tooltip,classNames:h.classNames}),onKey:e=>{[ea,ta,aa].includes(e.key)||Xt(e.key)||("¨"!==j?f.cellKeyEvt(a,e.type,e.key,e.shiftKey):m.cellChangeEvt(a,""))},onChange:({target:e})=>{const t=e.value.replace(j,"")[0];m.cellChangeEvt(a,t),t&&"¨"!==t&&f.cellChangeEvt(a)},onFocus:()=>{f.cellFocusEvt(a)},onBlur:()=>{f.cellBlurEvt(a)},customEvents:[{name:"specialchars:inserted",callback:e=>{m.cellChangeEvt(a,e.value),f.cellChangeEvt(a)}}]})};ra.propTypes={id:c.a.string,x:c.a.number,y:c.a.number,label:c.a.string,lowercase:c.a.bool,solutionDataValue:c.a.string,userDataValue:c.a.string,uiData:c.a.shape({id:c.a.string,enabled:c.a.bool,dataType:c.a.string}),words:c.a.arrayOf(c.a.shape({id:c.a.string,label:c.a.number})),wordsUIData:c.a.arrayOf(c.a.shape({id:c.a.string,validationType:c.a.string,extra:c.a.array})),wordsValidationData:c.a.arrayOf(c.a.shape({id:c.a.string,correct:c.a.bool,filled:c.a.bool})),wordsUserData:c.a.arrayOf(c.a.shape({id:c.a.string,value:c.a.string}))};var ia=Object(n.connect)((e,t)=>({solutionDataValue:Wt(e,t),userDataValue:Qt(e,t),uiData:J(e,t),words:le(e,t),wordsUserData:gt(e,t),wordsValidationData:wt(e,t),wordsUIData:Ot(e,t),lowercase:U(e,t)}))(ra),sa=a(257),ca=a.n(sa);const na=e=>e._,la=e=>e.$||{},oa=e=>e["#name"],da=(e,t)=>{if((e=>"__text__"===e["#name"])(e))return t({text:na(e)});la(e);const a=(e=>e.$$||[])(e).map(e=>da(e,t));return t({tag:oa(e),attrs:la(e),children:a})},ua=DPReactComponents.components.general.Audio.TinyAudioPlayer,ya=({title:e,mediaRef:t,hasPauseBehaviour:a,hasSpeed:s,persistVolume:c,preloadAuto:n,playedFullyLimit:l,style:o})=>{const[d,u]=Object(r.useState)(!1),[y,p]=Object(r.useState)(!0),[v,b]=Object(r.useState)(0),[m,f]=Object(r.useState)(!1),[I,C]=Object(r.useState)(!1),[g,O]=Object(r.useState)(null),[w,h]=Object(r.useState)(!1),[D,j]=Object(r.useState)(0),[x,E]=Object(r.useState)(0),S=Object(r.useRef)(),T=l,U=!!l,R=a5.dp.config.audioTinyPlayerPlayspeedButton,k=()=>{E(S.current.position())},A=()=>{k(),clearInterval(g),O(null)};Object(r.useEffect)(()=>()=>clearInterval(g),[g]),Object(r.useEffect)(()=>{a5.service.media.audio.bind("ready",()=>{S.current=a5.service.media.audio.create(t,{preload:n}),n&&S.current.load(),p(!1)})},[]);const P=Object(r.useCallback)(()=>{h(!0),j(S.current.duration())},[]),_=Object(r.useCallback)(()=>{u(!1),A()},[]),q=Object(r.useCallback)(()=>{a5.service.media.pauseAll({except:S.current}),u(!0),(()=>{const e=setInterval(k,100);O(e)})()},[]),B=Object(r.useCallback)(()=>{U&&b(e=>e+1),A(),E(0)},[]);Object(r.useEffect)(()=>(S.current.bind("paused",_),S.current.bind("stopped",_),S.current.bind("start",q),S.current.bind("ended",B),S.current.bind("loadprogress",P),()=>{S.current.unbind("paused",_),S.current.unbind("stopped",_),S.current.unbind("start",q),S.current.unbind("ended",B),S.current.unbind("loadprogress",P)}),[P,B,q,_]),Object(r.useEffect)(()=>{v>=T&&(S.current.disable(),f(!0))},[v]),Object(r.useEffect)(()=>{I?S.current.rate(R):S.current.rate(1)},[I]);return i.a.createElement(ua,{playing:d,loading:y,disabled:m,title:e,playbacks:v,limit:T,showLimit:U,speedEnabled:I,hasSpeed:s,hasPauseBehaviour:a,onPlayClick:()=>{d?a?S.current.pause():S.current.stop():S.current.play()},onSpeedClick:()=>{C(!I)},current:x,duration:D})};ya.propTypes={title:c.a.string,mediaRef:c.a.string.isRequired,hasPauseBehaviour:c.a.bool,hasSpeed:c.a.bool,persistVolume:c.a.bool,preloadAuto:c.a.bool,playedFullyLimit:c.a.number,style:c.a.string};var pa=ya;const va=({id:e,data:t,style:a,playerType:r="tinyPlayer",mediaPlaybackLimit:s,audioIconBehaviourIsPause:c,audioSpeedIsOn:n,screenId:l})=>{const o={mediaRef:t,playedFullyLimit:parseInt(s,10),hasSpeed:n,hasPauseBehaviour:c};return{tinyPlayer:i.a.createElement(pa,o),fullPlayer:i.a.createElement("span",null,"TODO: Implement React Full Player"),nativePlayer:i.a.createElement("span",null,"TODO: Implement React Native Player")}[r]};va.propTypes={id:c.a.string.isRequired,data:c.a.string.isRequired,style:c.a.string,playerType:c.a.oneOf(["tinyPlayer","fullPlayer","nativePlayer"]).isRequired,screenId:c.a.number};var ba=Object(n.connect)((e,t)=>({mediaPlaybackLimit:_(e,t),audioIconBehaviourIsPause:k(e,t),audioSpeedIsOn:P(e,t)}))(va);const ma=e=>{const{tag:t}=e,a=t;return i.a.createElement(a,e)};ma.propTypes={tag:c.a.string.isRequired};var fa=ma;const Ia=DPReactComponents.components.general.Image,Ca=({id:e,src:t,alt:a,class:s,style:c,"data-hotspots":n})=>{const[l,o]=Object(r.useState)(!1);return i.a.createElement(Ia,{id:e,src:A5.ASSET_URL_BUILDER(t),alt:a,classes:s,style:c,expanded:l,onExpandClick:()=>{o(!l)}})};Ca.propTypes={id:c.a.string.isRequired,src:c.a.string.isRequired,alt:c.a.string,class:c.a.string,style:c.a.object,"data-hotspots":c.a.string};var ga=Ca;const Oa=DPReactComponents.components.general.Text,wa=({text:e})=>i.a.createElement(Oa,{text:e});wa.propTypes={text:c.a.string.required};var ha=wa;const Da=({xml:e,screenId:t})=>{const a=({tag:e,attrs:a,children:r,text:s})=>{if(s)return i.a.createElement(ha,{text:s,screenId:t});if("root"===e)return i.a.createElement(i.a.Fragment,null,r);let c;switch(e){case"object":c=ba;break;case"img":c=ga;break;default:c=fa}const n={tag:e,...a,style:(l=a.style,"string"==typeof l?l.split(";").reduce((e,t)=>{const a=t.indexOf(":");if(-1===a)return e;const r=t.slice(0,a).trim().replace(/-./g,e=>e.slice(1).toUpperCase()),i=t.slice(a+1).trim();return i?{...e,[r]:i}:e},{}):{}),screenId:t,children:r};var l;return i.a.createElement(c,n)},[s,c]=Object(r.useState)();return Object(r.useEffect)(()=>{(async()=>{const t=await(async e=>{const t=new ca.a.Parser({charsAsChildren:!0,explicitChildren:!0,preserveChildrenOrder:!0,explicitRoot:!1,normalizeTags:!0,normalize:!0});return await t.parseStringPromise(e)})(e);c(t)})()},[e]),s?((e,t)=>da(e,t))(s,a):null};Da.propTypes={xml:c.a.string.required,screenId:c.a.number};var ja=Da;const xa=({clue:e,screenId:t})=>i.a.createElement(ja,{xml:`<root>${e.join("")}</root>`,screenId:t});xa.propTypes={clue:c.a.array.isRequired,screenId:c.a.number};var Ea=xa;const Sa=({itemData:e,screenId:t,words:a})=>{var s,c;const[n,l]=Object(r.useState)(!1),o=Object(r.useContext)(zt),d=Object(r.useContext)($t),u=t=>e.find(e=>e.align===t),y=a.some(e=>e===d.focusedWordId);return i.a.createElement(Rt,{horizontalId:null===(s=u("h"))||void 0===s?void 0:s.id,verticalId:null===(c=u("v"))||void 0===c?void 0:c.id,onMouseOver:()=>{o.mouseOverEvent(e.map(({id:e})=>e)),l(!0)},onMouseOut:()=>{o.mouseOutEvent(),l(!1)},isCluesWordFocused:y},e.map(e=>i.a.createElement(qt,{key:e.id,orientation:"h"===e.align?"horizontal":"vertical",visible:e.id===d.focusedWordId||n},i.a.createElement(Ea,{id:e.id,clue:e.clue,screenId:t}))))};Sa.propTypes={screenId:c.a.number,index:c.a.number,itemData:c.a.arrayOf(c.a.shape({id:c.a.string,cells:c.a.array,align:c.a.string})),words:c.a.arrayOf(c.a.string)};var Ta=Object(n.connect)((e,t)=>({itemData:oe(e,t)}))(Sa);const Ua=({cells:e,activityId:t,screenId:a})=>{const r=e.map(e=>e.words.length?"clue"===e.type?i.a.createElement(Ta,jt()({key:e.id},e,{screenId:a,activityId:t})):i.a.createElement(ia,jt()({key:e.id},e,{screenId:a,activityId:t})):i.a.createElement(kt,{key:e.id}));return i.a.createElement(Tt,null,r)};Ua.propTypes={cells:c.a.array.isRequired,activityId:c.a.string.isRequired,screenId:c.a.number.isRequired};var Ra=Object(n.connect)((e,t)=>({cells:ne(e,t)}))(Ua);const ka=({rows:e,cols:t,activityId:a,screenId:r})=>{const s=Array.from({length:e},(e,s)=>i.a.createElement(Ra,{key:s,index:s,cols:t,activityId:a,screenId:r}));return i.a.createElement(St,null,s)};ka.propTypes={rows:c.a.number.isRequired,cols:c.a.number.isRequired,activityId:c.a.string.isRequired,screenId:c.a.number.isRequired};var Aa=ka;const Pa=({label:e,clue:t,id:a,screenId:s,cells:c})=>{const n=Object(r.useContext)(zt),l=Object(r.useContext)($t),o=c.includes(l.focusedCellId);return i.a.createElement(At,{label:e,onMouseOver:()=>n.mouseOverEvent([a]),onMouseOut:()=>n.mouseOutEvent(),isCluesCellFocused:o,visible:l.focusedWordId===a},i.a.createElement(Ea,{id:a,clue:t,screenId:s}))};Pa.propTypes={label:c.a.number.isRequired,clue:c.a.arrayOf(c.a.string).isRequired,id:c.a.string.isRequired,screenId:c.a.number,cells:c.a.arrayOf(c.a.string)};var _a=Pa;const qa=({align:e,clues:t,screenId:a})=>{const r=t.map(e=>i.a.createElement(_a,jt()({key:e.id},e,{screenId:a})));return i.a.createElement(Pt,{orientation:"v"===e?"vertical":"horizontal"},r)};qa.propTypes={align:c.a.string,clues:c.a.array,screenId:c.a.number};var Ba=Object(n.connect)((e,t)=>({clues:ft(e,t)}))(qa);const $a=({activityId:e,screenId:t,cluesInColumns:a})=>i.a.createElement(_t,{cluesInColumn:a},["h","v"].map((a,r)=>i.a.createElement(Ba,{key:r,align:a,activityId:e,screenId:t})));$a.propTypes={activityId:c.a.string,screenId:c.a.number,cluesInColumns:c.a.bool};var za=$a;const La=({words:e,children:t})=>{const[a,s]=Object(r.useState)([]),[c,n]=Object(r.useState)([]);return i.a.createElement(zt.Provider,{value:{highlighted:a,highlightedWords:c,mouseOverEvent:t=>{s(e.filter(({id:e})=>t.includes(e)).map(({cells:e})=>e).flat()),n(t)},mouseOutEvent:()=>{s([]),n([])}}},t)};La.propTypes={words:c.a.array.isRequired,children:c.a.node};var Va=Object(n.connect)((e,t)=>({words:Object(q.getActivityItemData)(e,t)}))(La);const Fa=({setUserData:e,removeUserData:t,children:a})=>i.a.createElement(Bt.Provider,{value:{cellChangeEvt:(a,r)=>{r?e({id:a,value:r}):t({id:a})}}},a);Fa.propTypes={setUserData:c.a.func.isRequired,removeUserData:c.a.func.isRequired,children:c.a.object};var Na=Object(n.connect)(null,(e,t)=>({setUserData:a=>e(qe.setCellUserData({...a,activityId:t.activityId})),removeUserData:t=>e(qe.clearCellUserData({...t,data:[t.id]}))}))(Fa),Ma=a(283),Wa=a.n(Ma),Ha=a(330),Ka=a.n(Ha);const Ga=({editableCells:e,editableWords:t,rowSize:a,colSize:s,children:c})=>{const[n,l]=Object(r.useState)(),[o,d]=Object(r.useState)(),[u,y]=Object(r.useState)("h"),p=({x:t,y:a})=>e.find(e=>e.x===t&&e.y===a),v=t=>t.cells.map(t=>e.find(e=>e.id===t)).filter(Boolean),b=e=>Wa()(e.words.map(e=>t.find(t=>t.id===e)).filter(Boolean),"align"),m=Wa()(t,"align"),f=(e,t,a)=>{let r=e,i=((e,t,a)=>{if(e.cells.includes(t.id)){const r=v(e);let i=Ka()(r,e=>e.id===t.id)+a;return i<0||i>=r.length?null:r[i]}})(e,t,a);if(!i){const t=Ka()(m,t=>t.id===e.id);r=m[(t+m.length+a)%m.length];const s=v(r);i=s[1===a?0:s.length-1]}return[i,r]},I=(e,t)=>{let r,i;if(Zt.includes(t)){let c=0,n=0;switch(t){case"ArrowUp":n=-1;break;case"ArrowDown":n=1;break;case"ArrowLeft":c=-1;break;case"ArrowRight":c=1}r=(({xStep:e,yStep:t},r)=>{let i,c=r.x,n=r.y;do{if(c+=e,n+=t,i=p({x:c,y:n}),i){r=i;break}}while(c>=0&&c<=a&&n>=0&&n<=s);return r})({xStep:c,yStep:n},e),r&&(i=b(r)[0])}return[r,i]},C=Object(r.useCallback)((e,t,a,r)=>{let i,s,[c,n]=h(e);"keyup"===t?[i,s]=I(c,a):"keydown"===t&&([i,s]=((e,t,a,r)=>{let i,s;const c="Backspace"===a,n="Tab"===a,l=Xt(a);if(c||l||n){let a=c||n&&r?-1:1;[i,s]=f(t,e,a)}return[i,s]})(c,n,a,r)),i&&s&&(D(i,s),y(s.align))}),g=Object(r.useCallback)(e=>{let[t,a]=h(e),[r,i]=f(a,t,1);r&&i&&(D(r,i),y(i.align))}),O=Object(r.useCallback)(t=>{const a=e.find(e=>e.id===t),r=b(a),i=Math.max(r.findIndex(({align:e})=>e===u),0);D(a,r[i])}),w=Object(r.useCallback)(e=>{o===e&&D({id:null},{id:null})}),h=a=>{let r,i;return a===o?(i=e.find(e=>e.id===o),r=t.find(e=>e.id===n),r=r||b(i)[0]):(i=e.find(e=>e.id===a),r=b(i)[0]),[i,r]},D=(e,t)=>{d(e.id),l(t.id)};return i.a.createElement($t.Provider,{value:{focusedCellId:o,focusedWordId:n,cellKeyEvt:C,cellFocusEvt:O,cellBlurEvt:w,cellChangeEvt:g}},c)};Ga.propTypes={rowSize:c.a.number.isRequired,colSize:c.a.number.isRequired,editableCells:c.a.array.isRequired,editableWords:c.a.array.isRequired,children:c.a.node};var Ja=Object(n.connect)((e,t)=>({editableCells:se(e,t),editableWords:de(e,t)}))(Ga);const Ya=({activityId:e,visible:t,cluesAreInside:a,cluesInColumns:r,screenId:s,colSize:c,rowSize:n,transactions:l})=>i.a.createElement(i.a.Fragment,null,!l.length&&t&&i.a.createElement(Ja,{activityId:e,screenId:s,rowSize:n,colSize:c},i.a.createElement(Na,{activityId:e,screenId:s},i.a.createElement(Va,{activityId:e,screenId:s},i.a.createElement(Et,{cluesAreInside:a},i.a.createElement(Aa,{activityId:e,screenId:s,cols:c,rows:n}),!a&&i.a.createElement(za,{activityId:e,screenId:s,cluesInColumns:r}))))));Ya.propTypes={activityId:c.a.string.isRequired,visible:c.a.bool,cluesAreInside:c.a.bool,cluesInColumns:c.a.bool.isRequired,screenId:c.a.number.isRequired,colSize:c.a.number,rowSize:c.a.number,transactions:c.a.array};t.default=Object(l.a)(Object(n.connect)((e,t)=>({cluesInColumns:A(e,t),cluesAreInside:R(e,t),colSize:bt(e,t),rowSize:mt(e,t),transactions:Object(ut.b)(e,t)}),null)(Ya),ht)}}]);